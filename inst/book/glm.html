<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Introduction to GLM | Data Skills for Reproducible Science</title>
  <meta name="description" content="This course provides an overview of skills needed for reproducible research and open science using the statistical programming language R. Students will learn about data visualisation, data tidying and wrangling, archiving, iteration and functions, probability and data simulations, general linear models, and reproducible workflows. Learning is reinforced through weekly assignments that involve working with different types of data." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Introduction to GLM | Data Skills for Reproducible Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This course provides an overview of skills needed for reproducible research and open science using the statistical programming language R. Students will learn about data visualisation, data tidying and wrangling, archiving, iteration and functions, probability and data simulations, general linear models, and reproducible workflows. Learning is reinforced through weekly assignments that involve working with different types of data." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Introduction to GLM | Data Skills for Reproducible Science" />
  
  <meta name="twitter:description" content="This course provides an overview of skills needed for reproducible research and open science using the statistical programming language R. Students will learn about data visualisation, data tidying and wrangling, archiving, iteration and functions, probability and data simulations, general linear models, and reproducible workflows. Learning is reinforced through weekly assignments that involve working with different types of data." />
  



<meta name="date" content="2021-08-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sim.html"/>
<link rel="next" href="repro.html"/>
<script src="libs/header-attrs-2.9.4/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.4.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<meta property="og:title" content="Chapter 9 Introduction to GLM | Data Skills for Reproducible Science">
<meta property="og:description" content="This course provides an overview of skills needed for reproducible research and open science using the statistical programming language R. Students will learn about data visualisation, data tidying and wrangling, archiving, iteration and functions, probability and data simulations, general linear models, and reproducible workflows. Learning is reinforced through weekly assignments that involve working with different types of data.">
<meta property="og:image" content="https://psyteachr.github.io/images/twitter/msc_ds.png">
<meta property="og:url" content="https://psyteachr.github.io/msc-data-skills">
<meta property="twitter:card" content="summary_large_image">

<link rel="shortcut icon" href="https://psyteachr.github.io/images/msc_ds.png">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6NP3MF25W3');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="include/psyteachr.css" type="text/css" />
<link rel="stylesheet" href="include/style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Skills for Reproducible Science</a></li>
<li><a href="https://psyteachr.github.io/reprosci" style="color: red;">Access the most up-to-date version</a></li>
<li><a href="https://zenodo.org/badge/latestdoi/166541547"><img src="https://zenodo.org/badge/166541547.svg" alt="DOI"></a></li>
<li><a href="https://www.youtube.com/playlist?list=PLA2iRWVwbpTIweEBHD2dOKjZHK1atRmXt">Video Playlist</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#course-aims"><i class="fa fa-check"></i><b>0.1</b> Course Aims</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#intended-learning-outcomes"><i class="fa fa-check"></i><b>0.2</b> Intended Learning Outcomes</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#course-resources"><i class="fa fa-check"></i><b>0.3</b> Course Resources</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#course-outline"><i class="fa fa-check"></i><b>0.4</b> Course Outline</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#formative-exercises"><i class="fa fa-check"></i><b>0.5</b> Formative Exercises</a></li>
<li class="chapter" data-level="0.6" data-path="index.html"><a href="index.html#i-found-a-bug"><i class="fa fa-check"></i><b>0.6</b> I found a bug!</a></li>
<li class="chapter" data-level="0.7" data-path="index.html"><a href="index.html#other-resources"><i class="fa fa-check"></i><b>0.7</b> Other Resources</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#ilo1"><i class="fa fa-check"></i><b>1.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#resources1"><i class="fa fa-check"></i><b>1.2</b> Resources</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#what-is-r"><i class="fa fa-check"></i><b>1.3</b> What is R?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#rconsole"><i class="fa fa-check"></i><b>1.3.1</b> The Base R Console</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#rstudio_ide"><i class="fa fa-check"></i><b>1.3.2</b> RStudio</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#configure-rstudio"><i class="fa fa-check"></i><b>1.3.3</b> Configure RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#getting-started"><i class="fa fa-check"></i><b>1.4</b> Getting Started</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#console"><i class="fa fa-check"></i><b>1.4.1</b> Console commands</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#vars"><i class="fa fa-check"></i><b>1.4.2</b> Objects</a></li>
<li class="chapter" data-level="1.4.3" data-path="intro.html"><a href="intro.html#the-environment"><i class="fa fa-check"></i><b>1.4.3</b> The environment</a></li>
<li class="chapter" data-level="1.4.4" data-path="intro.html"><a href="intro.html#whitespace"><i class="fa fa-check"></i><b>1.4.4</b> Whitespace</a></li>
<li class="chapter" data-level="1.4.5" data-path="intro.html"><a href="intro.html#function_syx"><i class="fa fa-check"></i><b>1.4.5</b> Function syntax</a></li>
<li class="chapter" data-level="1.4.6" data-path="intro.html"><a href="intro.html#help"><i class="fa fa-check"></i><b>1.4.6</b> Getting help</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#install-package"><i class="fa fa-check"></i><b>1.5</b> Add-on packages</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="intro.html"><a href="intro.html#installing-a-package"><i class="fa fa-check"></i><b>1.5.1</b> Installing a package</a></li>
<li class="chapter" data-level="1.5.2" data-path="intro.html"><a href="intro.html#loading-a-package"><i class="fa fa-check"></i><b>1.5.2</b> Loading a package</a></li>
<li class="chapter" data-level="1.5.3" data-path="intro.html"><a href="intro.html#install-from-github"><i class="fa fa-check"></i><b>1.5.3</b> Install from GitHub</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#projects"><i class="fa fa-check"></i><b>1.6</b> Organising a project</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="intro.html"><a href="intro.html#structure"><i class="fa fa-check"></i><b>1.6.1</b> Structure</a></li>
<li class="chapter" data-level="1.6.2" data-path="intro.html"><a href="intro.html#rmarkdown"><i class="fa fa-check"></i><b>1.6.2</b> Reproducible reports with R Markdown</a></li>
<li class="chapter" data-level="1.6.3" data-path="intro.html"><a href="intro.html#working-directory"><i class="fa fa-check"></i><b>1.6.3</b> Working Directory</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#glossary1"><i class="fa fa-check"></i><b>1.7</b> Glossary</a></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#exercises1"><i class="fa fa-check"></i><b>1.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> Working with Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data.html"><a href="data.html#ilo2"><i class="fa fa-check"></i><b>2.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="data.html"><a href="data.html#resources2"><i class="fa fa-check"></i><b>2.2</b> Resources</a></li>
<li class="chapter" data-level="2.3" data-path="data.html"><a href="data.html#setup2"><i class="fa fa-check"></i><b>2.3</b> Setup</a></li>
<li class="chapter" data-level="2.4" data-path="data.html"><a href="data.html#data-tables"><i class="fa fa-check"></i><b>2.4</b> Data tables</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data.html"><a href="data.html#builtin"><i class="fa fa-check"></i><b>2.4.1</b> Built-in data</a></li>
<li class="chapter" data-level="2.4.2" data-path="data.html"><a href="data.html#import_data"><i class="fa fa-check"></i><b>2.4.2</b> Importing data</a></li>
<li class="chapter" data-level="2.4.3" data-path="data.html"><a href="data.html#creating-data"><i class="fa fa-check"></i><b>2.4.3</b> Creating data</a></li>
<li class="chapter" data-level="2.4.4" data-path="data.html"><a href="data.html#writing-data"><i class="fa fa-check"></i><b>2.4.4</b> Writing Data</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data.html"><a href="data.html#data_types"><i class="fa fa-check"></i><b>2.5</b> Basic data types</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="data.html"><a href="data.html#numeric-data"><i class="fa fa-check"></i><b>2.5.1</b> Numeric data</a></li>
<li class="chapter" data-level="2.5.2" data-path="data.html"><a href="data.html#character-data"><i class="fa fa-check"></i><b>2.5.2</b> Character data</a></li>
<li class="chapter" data-level="2.5.3" data-path="data.html"><a href="data.html#logical-data"><i class="fa fa-check"></i><b>2.5.3</b> Logical Data</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="data.html"><a href="data.html#containers"><i class="fa fa-check"></i><b>2.6</b> Basic container types</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="data.html"><a href="data.html#vectors"><i class="fa fa-check"></i><b>2.6.1</b> Vectors</a></li>
<li class="chapter" data-level="2.6.2" data-path="data.html"><a href="data.html#lists"><i class="fa fa-check"></i><b>2.6.2</b> Lists</a></li>
<li class="chapter" data-level="2.6.3" data-path="data.html"><a href="data.html#tables"><i class="fa fa-check"></i><b>2.6.3</b> Tables</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="data.html"><a href="data.html#troubleshooting"><i class="fa fa-check"></i><b>2.7</b> Troubleshooting</a></li>
<li class="chapter" data-level="2.8" data-path="data.html"><a href="data.html#glossary2"><i class="fa fa-check"></i><b>2.8</b> Glossary</a></li>
<li class="chapter" data-level="2.9" data-path="data.html"><a href="data.html#exercises2"><i class="fa fa-check"></i><b>2.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ggplot.html"><a href="ggplot.html"><i class="fa fa-check"></i><b>3</b> Data Visualisation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ggplot.html"><a href="ggplot.html#ilo3"><i class="fa fa-check"></i><b>3.1</b> Learning Objectives</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="ggplot.html"><a href="ggplot.html#basic"><i class="fa fa-check"></i><b>3.1.1</b> Basic</a></li>
<li class="chapter" data-level="3.1.2" data-path="ggplot.html"><a href="ggplot.html#intermediate"><i class="fa fa-check"></i><b>3.1.2</b> Intermediate</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ggplot.html"><a href="ggplot.html#resources3"><i class="fa fa-check"></i><b>3.2</b> Resources</a></li>
<li class="chapter" data-level="3.3" data-path="ggplot.html"><a href="ggplot.html#setup3"><i class="fa fa-check"></i><b>3.3</b> Setup</a></li>
<li class="chapter" data-level="3.4" data-path="ggplot.html"><a href="ggplot.html#vartypes"><i class="fa fa-check"></i><b>3.4</b> Common Variable Combinations</a></li>
<li class="chapter" data-level="3.5" data-path="ggplot.html"><a href="ggplot.html#basic-plots"><i class="fa fa-check"></i><b>3.5</b> Basic Plots</a></li>
<li class="chapter" data-level="3.6" data-path="ggplot.html"><a href="ggplot.html#ggplots"><i class="fa fa-check"></i><b>3.6</b> GGplots</a></li>
<li class="chapter" data-level="3.7" data-path="ggplot.html"><a href="ggplot.html#common-plot-types"><i class="fa fa-check"></i><b>3.7</b> Common Plot Types</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="ggplot.html"><a href="ggplot.html#geom_bar"><i class="fa fa-check"></i><b>3.7.1</b> Bar plot</a></li>
<li class="chapter" data-level="3.7.2" data-path="ggplot.html"><a href="ggplot.html#geom_density"><i class="fa fa-check"></i><b>3.7.2</b> Density plot</a></li>
<li class="chapter" data-level="3.7.3" data-path="ggplot.html"><a href="ggplot.html#geom_freqpoly"><i class="fa fa-check"></i><b>3.7.3</b> Frequency polygons</a></li>
<li class="chapter" data-level="3.7.4" data-path="ggplot.html"><a href="ggplot.html#geom_histogram"><i class="fa fa-check"></i><b>3.7.4</b> Histogram</a></li>
<li class="chapter" data-level="3.7.5" data-path="ggplot.html"><a href="ggplot.html#geom_col"><i class="fa fa-check"></i><b>3.7.5</b> Column plot</a></li>
<li class="chapter" data-level="3.7.6" data-path="ggplot.html"><a href="ggplot.html#geom_boxplot"><i class="fa fa-check"></i><b>3.7.6</b> Boxplot</a></li>
<li class="chapter" data-level="3.7.7" data-path="ggplot.html"><a href="ggplot.html#geom_violin"><i class="fa fa-check"></i><b>3.7.7</b> Violin plot</a></li>
<li class="chapter" data-level="3.7.8" data-path="ggplot.html"><a href="ggplot.html#vertical_intervals"><i class="fa fa-check"></i><b>3.7.8</b> Vertical intervals</a></li>
<li class="chapter" data-level="3.7.9" data-path="ggplot.html"><a href="ggplot.html#geom_point"><i class="fa fa-check"></i><b>3.7.9</b> Scatter plot</a></li>
<li class="chapter" data-level="3.7.10" data-path="ggplot.html"><a href="ggplot.html#geom_smooth"><i class="fa fa-check"></i><b>3.7.10</b> Line graph</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="ggplot.html"><a href="ggplot.html#customisation"><i class="fa fa-check"></i><b>3.8</b> Customisation</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="ggplot.html"><a href="ggplot.html#custom-labels"><i class="fa fa-check"></i><b>3.8.1</b> Labels</a></li>
<li class="chapter" data-level="3.8.2" data-path="ggplot.html"><a href="ggplot.html#custom-colours"><i class="fa fa-check"></i><b>3.8.2</b> Colours</a></li>
<li class="chapter" data-level="3.8.3" data-path="ggplot.html"><a href="ggplot.html#themes"><i class="fa fa-check"></i><b>3.8.3</b> Themes</a></li>
<li class="chapter" data-level="3.8.4" data-path="ggplot.html"><a href="ggplot.html#ggsave"><i class="fa fa-check"></i><b>3.8.4</b> Save as file</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="ggplot.html"><a href="ggplot.html#combo_plots"><i class="fa fa-check"></i><b>3.9</b> Combination Plots</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="ggplot.html"><a href="ggplot.html#violinbox-plot"><i class="fa fa-check"></i><b>3.9.1</b> Violinbox plot</a></li>
<li class="chapter" data-level="3.9.2" data-path="ggplot.html"><a href="ggplot.html#violin-point-range-plot"><i class="fa fa-check"></i><b>3.9.2</b> Violin-point-range plot</a></li>
<li class="chapter" data-level="3.9.3" data-path="ggplot.html"><a href="ggplot.html#violin-jitter-plot"><i class="fa fa-check"></i><b>3.9.3</b> Violin-jitter plot</a></li>
<li class="chapter" data-level="3.9.4" data-path="ggplot.html"><a href="ggplot.html#scatter-line-graph"><i class="fa fa-check"></i><b>3.9.4</b> Scatter-line graph</a></li>
<li class="chapter" data-level="3.9.5" data-path="ggplot.html"><a href="ggplot.html#cowplot"><i class="fa fa-check"></i><b>3.9.5</b> Grid of plots</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="ggplot.html"><a href="ggplot.html#overlap"><i class="fa fa-check"></i><b>3.10</b> Overlapping Discrete Data</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="ggplot.html"><a href="ggplot.html#reducing-opacity"><i class="fa fa-check"></i><b>3.10.1</b> Reducing Opacity</a></li>
<li class="chapter" data-level="3.10.2" data-path="ggplot.html"><a href="ggplot.html#geom_count"><i class="fa fa-check"></i><b>3.10.2</b> Proportional Dot Plots</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="ggplot.html"><a href="ggplot.html#overlapping-continuous-data"><i class="fa fa-check"></i><b>3.11</b> Overlapping Continuous Data</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="ggplot.html"><a href="ggplot.html#geom_density2d"><i class="fa fa-check"></i><b>3.11.1</b> 2D Density Plot</a></li>
<li class="chapter" data-level="3.11.2" data-path="ggplot.html"><a href="ggplot.html#geom_bin2d"><i class="fa fa-check"></i><b>3.11.2</b> 2D Histogram</a></li>
<li class="chapter" data-level="3.11.3" data-path="ggplot.html"><a href="ggplot.html#geom_hex"><i class="fa fa-check"></i><b>3.11.3</b> Hexagonal Heatmap</a></li>
<li class="chapter" data-level="3.11.4" data-path="ggplot.html"><a href="ggplot.html#geom_tile"><i class="fa fa-check"></i><b>3.11.4</b> Correlation Heatmap</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="ggplot.html"><a href="ggplot.html#plotly"><i class="fa fa-check"></i><b>3.12</b> Interactive Plots</a></li>
<li class="chapter" data-level="3.13" data-path="ggplot.html"><a href="ggplot.html#glossary3"><i class="fa fa-check"></i><b>3.13</b> Glossary</a></li>
<li class="chapter" data-level="3.14" data-path="ggplot.html"><a href="ggplot.html#exercises3"><i class="fa fa-check"></i><b>3.14</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidyr.html"><a href="tidyr.html"><i class="fa fa-check"></i><b>4</b> Tidy Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tidyr.html"><a href="tidyr.html#ilo4"><i class="fa fa-check"></i><b>4.1</b> Learning Objectives</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="tidyr.html"><a href="tidyr.html#basic-1"><i class="fa fa-check"></i><b>4.1.1</b> Basic</a></li>
<li class="chapter" data-level="4.1.2" data-path="tidyr.html"><a href="tidyr.html#advanced"><i class="fa fa-check"></i><b>4.1.2</b> Advanced</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tidyr.html"><a href="tidyr.html#resources4"><i class="fa fa-check"></i><b>4.2</b> Resources</a></li>
<li class="chapter" data-level="4.3" data-path="tidyr.html"><a href="tidyr.html#setup4"><i class="fa fa-check"></i><b>4.3</b> Setup</a></li>
<li class="chapter" data-level="4.4" data-path="tidyr.html"><a href="tidyr.html#tidy-data"><i class="fa fa-check"></i><b>4.4</b> Tidy Data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="tidyr.html"><a href="tidyr.html#three-rules"><i class="fa fa-check"></i><b>4.4.1</b> Three Rules</a></li>
<li class="chapter" data-level="4.4.2" data-path="tidyr.html"><a href="tidyr.html#wide_long"><i class="fa fa-check"></i><b>4.4.2</b> Wide versus long</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="tidyr.html"><a href="tidyr.html#pivot"><i class="fa fa-check"></i><b>4.5</b> Pivot Functions</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="tidyr.html"><a href="tidyr.html#load-data"><i class="fa fa-check"></i><b>4.5.1</b> Load Data</a></li>
<li class="chapter" data-level="4.5.2" data-path="tidyr.html"><a href="tidyr.html#pivot_longer"><i class="fa fa-check"></i><b>4.5.2</b> pivot_longer()</a></li>
<li class="chapter" data-level="4.5.3" data-path="tidyr.html"><a href="tidyr.html#pivot_wider"><i class="fa fa-check"></i><b>4.5.3</b> pivot_wider()</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="tidyr.html"><a href="tidyr.html#tidy-verbs"><i class="fa fa-check"></i><b>4.6</b> Tidy Verbs</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="tidyr.html"><a href="tidyr.html#gather"><i class="fa fa-check"></i><b>4.6.1</b> gather()</a></li>
<li class="chapter" data-level="4.6.2" data-path="tidyr.html"><a href="tidyr.html#separate"><i class="fa fa-check"></i><b>4.6.2</b> separate()</a></li>
<li class="chapter" data-level="4.6.3" data-path="tidyr.html"><a href="tidyr.html#unite"><i class="fa fa-check"></i><b>4.6.3</b> unite()</a></li>
<li class="chapter" data-level="4.6.4" data-path="tidyr.html"><a href="tidyr.html#spread"><i class="fa fa-check"></i><b>4.6.4</b> spread()</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="tidyr.html"><a href="tidyr.html#pipes"><i class="fa fa-check"></i><b>4.7</b> Pipes</a></li>
<li class="chapter" data-level="4.8" data-path="tidyr.html"><a href="tidyr.html#more-complex-example"><i class="fa fa-check"></i><b>4.8</b> More Complex Example</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="tidyr.html"><a href="tidyr.html#load-data-1"><i class="fa fa-check"></i><b>4.8.1</b> Load Data</a></li>
<li class="chapter" data-level="4.8.2" data-path="tidyr.html"><a href="tidyr.html#wide-to-long"><i class="fa fa-check"></i><b>4.8.2</b> Wide to Long</a></li>
<li class="chapter" data-level="4.8.3" data-path="tidyr.html"><a href="tidyr.html#one-piece-of-data-per-column"><i class="fa fa-check"></i><b>4.8.3</b> One Piece of Data per Column</a></li>
<li class="chapter" data-level="4.8.4" data-path="tidyr.html"><a href="tidyr.html#all-in-one-step"><i class="fa fa-check"></i><b>4.8.4</b> All in one step</a></li>
<li class="chapter" data-level="4.8.5" data-path="tidyr.html"><a href="tidyr.html#columns-by-year"><i class="fa fa-check"></i><b>4.8.5</b> Columns by Year</a></li>
<li class="chapter" data-level="4.8.6" data-path="tidyr.html"><a href="tidyr.html#experimentum-data"><i class="fa fa-check"></i><b>4.8.6</b> Experimentum Data</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="tidyr.html"><a href="tidyr.html#glossary4"><i class="fa fa-check"></i><b>4.9</b> Glossary</a></li>
<li class="chapter" data-level="4.10" data-path="tidyr.html"><a href="tidyr.html#exercises4"><i class="fa fa-check"></i><b>4.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>5</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="dplyr.html"><a href="dplyr.html#ilo5"><i class="fa fa-check"></i><b>5.1</b> Learning Objectives</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="dplyr.html"><a href="dplyr.html#basic-2"><i class="fa fa-check"></i><b>5.1.1</b> Basic</a></li>
<li class="chapter" data-level="5.1.2" data-path="dplyr.html"><a href="dplyr.html#intermediate-1"><i class="fa fa-check"></i><b>5.1.2</b> Intermediate</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="dplyr.html"><a href="dplyr.html#resources5"><i class="fa fa-check"></i><b>5.2</b> Resources</a></li>
<li class="chapter" data-level="5.3" data-path="dplyr.html"><a href="dplyr.html#setup5"><i class="fa fa-check"></i><b>5.3</b> Setup</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="dplyr.html"><a href="dplyr.html#data-disgust"><i class="fa fa-check"></i><b>5.3.1</b> The <code>disgust</code> dataset</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="dplyr.html"><a href="dplyr.html#six-main-dplyr-verbs"><i class="fa fa-check"></i><b>5.4</b> Six main dplyr verbs</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="dplyr.html"><a href="dplyr.html#select"><i class="fa fa-check"></i><b>5.4.1</b> select()</a></li>
<li class="chapter" data-level="5.4.2" data-path="dplyr.html"><a href="dplyr.html#filter"><i class="fa fa-check"></i><b>5.4.2</b> filter()</a></li>
<li class="chapter" data-level="5.4.3" data-path="dplyr.html"><a href="dplyr.html#arrange"><i class="fa fa-check"></i><b>5.4.3</b> arrange()</a></li>
<li class="chapter" data-level="5.4.4" data-path="dplyr.html"><a href="dplyr.html#mutate"><i class="fa fa-check"></i><b>5.4.4</b> mutate()</a></li>
<li class="chapter" data-level="5.4.5" data-path="dplyr.html"><a href="dplyr.html#summarise"><i class="fa fa-check"></i><b>5.4.5</b> summarise()</a></li>
<li class="chapter" data-level="5.4.6" data-path="dplyr.html"><a href="dplyr.html#group_by"><i class="fa fa-check"></i><b>5.4.6</b> group_by()</a></li>
<li class="chapter" data-level="5.4.7" data-path="dplyr.html"><a href="dplyr.html#all-together"><i class="fa fa-check"></i><b>5.4.7</b> All Together</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="dplyr.html"><a href="dplyr.html#additional-dplyr-one-table-verbs"><i class="fa fa-check"></i><b>5.5</b> Additional dplyr one-table verbs</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="dplyr.html"><a href="dplyr.html#rename"><i class="fa fa-check"></i><b>5.5.1</b> rename()</a></li>
<li class="chapter" data-level="5.5.2" data-path="dplyr.html"><a href="dplyr.html#distinct"><i class="fa fa-check"></i><b>5.5.2</b> distinct()</a></li>
<li class="chapter" data-level="5.5.3" data-path="dplyr.html"><a href="dplyr.html#count"><i class="fa fa-check"></i><b>5.5.3</b> count()</a></li>
<li class="chapter" data-level="5.5.4" data-path="dplyr.html"><a href="dplyr.html#slice"><i class="fa fa-check"></i><b>5.5.4</b> slice()</a></li>
<li class="chapter" data-level="5.5.5" data-path="dplyr.html"><a href="dplyr.html#pull"><i class="fa fa-check"></i><b>5.5.5</b> pull()</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="dplyr.html"><a href="dplyr.html#window"><i class="fa fa-check"></i><b>5.6</b> Window functions</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="dplyr.html"><a href="dplyr.html#ranking-functions"><i class="fa fa-check"></i><b>5.6.1</b> Ranking functions</a></li>
<li class="chapter" data-level="5.6.2" data-path="dplyr.html"><a href="dplyr.html#offset-functions"><i class="fa fa-check"></i><b>5.6.2</b> Offset functions</a></li>
<li class="chapter" data-level="5.6.3" data-path="dplyr.html"><a href="dplyr.html#cumulative-aggregates"><i class="fa fa-check"></i><b>5.6.3</b> Cumulative aggregates</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="dplyr.html"><a href="dplyr.html#glossary5"><i class="fa fa-check"></i><b>5.7</b> Glossary</a></li>
<li class="chapter" data-level="5.8" data-path="dplyr.html"><a href="dplyr.html#exercises5"><i class="fa fa-check"></i><b>5.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="joins.html"><a href="joins.html"><i class="fa fa-check"></i><b>6</b> Data Relations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="joins.html"><a href="joins.html#ilo6"><i class="fa fa-check"></i><b>6.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="6.2" data-path="joins.html"><a href="joins.html#resources6"><i class="fa fa-check"></i><b>6.2</b> Resources</a></li>
<li class="chapter" data-level="6.3" data-path="joins.html"><a href="joins.html#setup6"><i class="fa fa-check"></i><b>6.3</b> Setup</a></li>
<li class="chapter" data-level="6.4" data-path="joins.html"><a href="joins.html#data-1"><i class="fa fa-check"></i><b>6.4</b> Data</a></li>
<li class="chapter" data-level="6.5" data-path="joins.html"><a href="joins.html#mutating-joins"><i class="fa fa-check"></i><b>6.5</b> Mutating Joins</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="joins.html"><a href="joins.html#left_join"><i class="fa fa-check"></i><b>6.5.1</b> left_join()</a></li>
<li class="chapter" data-level="6.5.2" data-path="joins.html"><a href="joins.html#right_join"><i class="fa fa-check"></i><b>6.5.2</b> right_join()</a></li>
<li class="chapter" data-level="6.5.3" data-path="joins.html"><a href="joins.html#inner_join"><i class="fa fa-check"></i><b>6.5.3</b> inner_join()</a></li>
<li class="chapter" data-level="6.5.4" data-path="joins.html"><a href="joins.html#full_join"><i class="fa fa-check"></i><b>6.5.4</b> full_join()</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="joins.html"><a href="joins.html#filtering-joins"><i class="fa fa-check"></i><b>6.6</b> Filtering Joins</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="joins.html"><a href="joins.html#semi_join"><i class="fa fa-check"></i><b>6.6.1</b> semi_join()</a></li>
<li class="chapter" data-level="6.6.2" data-path="joins.html"><a href="joins.html#anti_join"><i class="fa fa-check"></i><b>6.6.2</b> anti_join()</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="joins.html"><a href="joins.html#binding-joins"><i class="fa fa-check"></i><b>6.7</b> Binding Joins</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="joins.html"><a href="joins.html#bind_rows"><i class="fa fa-check"></i><b>6.7.1</b> bind_rows()</a></li>
<li class="chapter" data-level="6.7.2" data-path="joins.html"><a href="joins.html#bind_cols"><i class="fa fa-check"></i><b>6.7.2</b> bind_cols()</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="joins.html"><a href="joins.html#set-operations"><i class="fa fa-check"></i><b>6.8</b> Set Operations</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="joins.html"><a href="joins.html#intersect"><i class="fa fa-check"></i><b>6.8.1</b> intersect()</a></li>
<li class="chapter" data-level="6.8.2" data-path="joins.html"><a href="joins.html#union"><i class="fa fa-check"></i><b>6.8.2</b> union()</a></li>
<li class="chapter" data-level="6.8.3" data-path="joins.html"><a href="joins.html#setdiff"><i class="fa fa-check"></i><b>6.8.3</b> setdiff()</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="joins.html"><a href="joins.html#glossary6"><i class="fa fa-check"></i><b>6.9</b> Glossary</a></li>
<li class="chapter" data-level="6.10" data-path="joins.html"><a href="joins.html#exercises6"><i class="fa fa-check"></i><b>6.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="func.html"><a href="func.html"><i class="fa fa-check"></i><b>7</b> Iteration &amp; Functions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="func.html"><a href="func.html#ilo7"><i class="fa fa-check"></i><b>7.1</b> Learning Objectives</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="func.html"><a href="func.html#basic-3"><i class="fa fa-check"></i><b>7.1.1</b> Basic</a></li>
<li class="chapter" data-level="7.1.2" data-path="func.html"><a href="func.html#intermediate-2"><i class="fa fa-check"></i><b>7.1.2</b> Intermediate</a></li>
<li class="chapter" data-level="7.1.3" data-path="func.html"><a href="func.html#advanced-1"><i class="fa fa-check"></i><b>7.1.3</b> Advanced</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="func.html"><a href="func.html#resources7"><i class="fa fa-check"></i><b>7.2</b> Resources</a></li>
<li class="chapter" data-level="7.3" data-path="func.html"><a href="func.html#setup7"><i class="fa fa-check"></i><b>7.3</b> Setup</a></li>
<li class="chapter" data-level="7.4" data-path="func.html"><a href="func.html#iteration-functions"><i class="fa fa-check"></i><b>7.4</b> Iteration functions</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="func.html"><a href="func.html#rep"><i class="fa fa-check"></i><b>7.4.1</b> rep()</a></li>
<li class="chapter" data-level="7.4.2" data-path="func.html"><a href="func.html#seq"><i class="fa fa-check"></i><b>7.4.2</b> seq()</a></li>
<li class="chapter" data-level="7.4.3" data-path="func.html"><a href="func.html#replicate"><i class="fa fa-check"></i><b>7.4.3</b> replicate()</a></li>
<li class="chapter" data-level="7.4.4" data-path="func.html"><a href="func.html#map-apply"><i class="fa fa-check"></i><b>7.4.4</b> map() and apply() functions</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="func.html"><a href="func.html#custom-functions"><i class="fa fa-check"></i><b>7.5</b> Custom functions</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="func.html"><a href="func.html#structure-function"><i class="fa fa-check"></i><b>7.5.1</b> Structuring a function</a></li>
<li class="chapter" data-level="7.5.2" data-path="func.html"><a href="func.html#arguments"><i class="fa fa-check"></i><b>7.5.2</b> Arguments</a></li>
<li class="chapter" data-level="7.5.3" data-path="func.html"><a href="func.html#defaults"><i class="fa fa-check"></i><b>7.5.3</b> Argument defaults</a></li>
<li class="chapter" data-level="7.5.4" data-path="func.html"><a href="func.html#scope"><i class="fa fa-check"></i><b>7.5.4</b> Scope</a></li>
<li class="chapter" data-level="7.5.5" data-path="func.html"><a href="func.html#warnings-errors"><i class="fa fa-check"></i><b>7.5.5</b> Warnings and errors</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="func.html"><a href="func.html#iterating-your-own-functions"><i class="fa fa-check"></i><b>7.6</b> Iterating your own functions</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="func.html"><a href="func.html#rnorm"><i class="fa fa-check"></i><b>7.6.1</b> rnorm()</a></li>
<li class="chapter" data-level="7.6.2" data-path="func.html"><a href="func.html#tibbletibble"><i class="fa fa-check"></i><b>7.6.2</b> tibble::tibble()</a></li>
<li class="chapter" data-level="7.6.3" data-path="func.html"><a href="func.html#t.test"><i class="fa fa-check"></i><b>7.6.3</b> t.test()</a></li>
<li class="chapter" data-level="7.6.4" data-path="func.html"><a href="func.html#broomtidy"><i class="fa fa-check"></i><b>7.6.4</b> broom::tidy()</a></li>
<li class="chapter" data-level="7.6.5" data-path="func.html"><a href="func.html#custom-function-t_sim"><i class="fa fa-check"></i><b>7.6.5</b> Custom function: t_sim()</a></li>
<li class="chapter" data-level="7.6.6" data-path="func.html"><a href="func.html#iterate-t_sim"><i class="fa fa-check"></i><b>7.6.6</b> Iterate t_sim()</a></li>
<li class="chapter" data-level="7.6.7" data-path="func.html"><a href="func.html#seed"><i class="fa fa-check"></i><b>7.6.7</b> Set seed</a></li>
<li class="chapter" data-level="7.6.8" data-path="func.html"><a href="func.html#add-arguments"><i class="fa fa-check"></i><b>7.6.8</b> Add arguments</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="func.html"><a href="func.html#glossary7"><i class="fa fa-check"></i><b>7.7</b> Glossary</a></li>
<li class="chapter" data-level="7.8" data-path="func.html"><a href="func.html#exercises7"><i class="fa fa-check"></i><b>7.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sim.html"><a href="sim.html"><i class="fa fa-check"></i><b>8</b> Probability &amp; Simulation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sim.html"><a href="sim.html#ilo8"><i class="fa fa-check"></i><b>8.1</b> Learning Objectives</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="sim.html"><a href="sim.html#basic-4"><i class="fa fa-check"></i><b>8.1.1</b> Basic</a></li>
<li class="chapter" data-level="8.1.2" data-path="sim.html"><a href="sim.html#intermediate-3"><i class="fa fa-check"></i><b>8.1.2</b> Intermediate</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sim.html"><a href="sim.html#resources8"><i class="fa fa-check"></i><b>8.2</b> Resources</a></li>
<li class="chapter" data-level="8.3" data-path="sim.html"><a href="sim.html#setup8"><i class="fa fa-check"></i><b>8.3</b> Setup</a></li>
<li class="chapter" data-level="8.4" data-path="sim.html"><a href="sim.html#univariate-distributions"><i class="fa fa-check"></i><b>8.4</b> Univariate Distributions</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="sim.html"><a href="sim.html#uniform"><i class="fa fa-check"></i><b>8.4.1</b> Uniform Distribution</a></li>
<li class="chapter" data-level="8.4.2" data-path="sim.html"><a href="sim.html#binomial"><i class="fa fa-check"></i><b>8.4.2</b> Binomial Distribution</a></li>
<li class="chapter" data-level="8.4.3" data-path="sim.html"><a href="sim.html#normal"><i class="fa fa-check"></i><b>8.4.3</b> Normal Distribution</a></li>
<li class="chapter" data-level="8.4.4" data-path="sim.html"><a href="sim.html#poisson"><i class="fa fa-check"></i><b>8.4.4</b> Poisson Distribution</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="sim.html"><a href="sim.html#mvdist"><i class="fa fa-check"></i><b>8.5</b> Multivariate Distributions</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="sim.html"><a href="sim.html#bvn"><i class="fa fa-check"></i><b>8.5.1</b> Bivariate Normal</a></li>
<li class="chapter" data-level="8.5.2" data-path="sim.html"><a href="sim.html#mvnorm"><i class="fa fa-check"></i><b>8.5.2</b> Multivariate Normal</a></li>
<li class="chapter" data-level="8.5.3" data-path="sim.html"><a href="sim.html#faux"><i class="fa fa-check"></i><b>8.5.3</b> Faux</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="sim.html"><a href="sim.html#stat-terms"><i class="fa fa-check"></i><b>8.6</b> Statistical terms</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="sim.html"><a href="sim.html#effect"><i class="fa fa-check"></i><b>8.6.1</b> Effect</a></li>
<li class="chapter" data-level="8.6.2" data-path="sim.html"><a href="sim.html#p-value"><i class="fa fa-check"></i><b>8.6.2</b> P-value</a></li>
<li class="chapter" data-level="8.6.3" data-path="sim.html"><a href="sim.html#alpha"><i class="fa fa-check"></i><b>8.6.3</b> Alpha</a></li>
<li class="chapter" data-level="8.6.4" data-path="sim.html"><a href="sim.html#false-pos"><i class="fa fa-check"></i><b>8.6.4</b> False Positive/Negative</a></li>
<li class="chapter" data-level="8.6.5" data-path="sim.html"><a href="sim.html#power"><i class="fa fa-check"></i><b>8.6.5</b> Power and SESOI</a></li>
<li class="chapter" data-level="8.6.6" data-path="sim.html"><a href="sim.html#conf-int"><i class="fa fa-check"></i><b>8.6.6</b> Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="sim.html"><a href="sim.html#tests"><i class="fa fa-check"></i><b>8.7</b> Tests</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="sim.html"><a href="sim.html#exact-binom"><i class="fa fa-check"></i><b>8.7.1</b> Exact binomial test</a></li>
<li class="chapter" data-level="8.7.2" data-path="sim.html"><a href="sim.html#t-test"><i class="fa fa-check"></i><b>8.7.2</b> T-test</a></li>
<li class="chapter" data-level="8.7.3" data-path="sim.html"><a href="sim.html#correlation"><i class="fa fa-check"></i><b>8.7.3</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="sim.html"><a href="sim.html#example"><i class="fa fa-check"></i><b>8.8</b> Example</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="sim.html"><a href="sim.html#load-wrangle"><i class="fa fa-check"></i><b>8.8.1</b> Load &amp; wrangle</a></li>
<li class="chapter" data-level="8.8.2" data-path="sim.html"><a href="sim.html#plot"><i class="fa fa-check"></i><b>8.8.2</b> Plot</a></li>
<li class="chapter" data-level="8.8.3" data-path="sim.html"><a href="sim.html#simulate-a-population"><i class="fa fa-check"></i><b>8.8.3</b> Simulate a population</a></li>
<li class="chapter" data-level="8.8.4" data-path="sim.html"><a href="sim.html#analyse-simulated-data"><i class="fa fa-check"></i><b>8.8.4</b> Analyse simulated data</a></li>
<li class="chapter" data-level="8.8.5" data-path="sim.html"><a href="sim.html#replicate-simulation"><i class="fa fa-check"></i><b>8.8.5</b> Replicate simulation</a></li>
<li class="chapter" data-level="8.8.6" data-path="sim.html"><a href="sim.html#one-tailed-prediction"><i class="fa fa-check"></i><b>8.8.6</b> One-tailed prediction</a></li>
<li class="chapter" data-level="8.8.7" data-path="sim.html"><a href="sim.html#range-of-sample-sizes"><i class="fa fa-check"></i><b>8.8.7</b> Range of sample sizes</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="sim.html"><a href="sim.html#glossary8"><i class="fa fa-check"></i><b>8.9</b> Glossary</a></li>
<li class="chapter" data-level="8.10" data-path="sim.html"><a href="sim.html#exercises8"><i class="fa fa-check"></i><b>8.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>9</b> Introduction to GLM</a>
<ul>
<li class="chapter" data-level="9.1" data-path="glm.html"><a href="glm.html#ilo9"><i class="fa fa-check"></i><b>9.1</b> Learning Objectives</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="glm.html"><a href="glm.html#basic-5"><i class="fa fa-check"></i><b>9.1.1</b> Basic</a></li>
<li class="chapter" data-level="9.1.2" data-path="glm.html"><a href="glm.html#intermediate-4"><i class="fa fa-check"></i><b>9.1.2</b> Intermediate</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="glm.html"><a href="glm.html#resources9"><i class="fa fa-check"></i><b>9.2</b> Resources</a></li>
<li class="chapter" data-level="9.3" data-path="glm.html"><a href="glm.html#setup9"><i class="fa fa-check"></i><b>9.3</b> Setup</a></li>
<li class="chapter" data-level="9.4" data-path="glm.html"><a href="glm.html#glm-1"><i class="fa fa-check"></i><b>9.4</b> GLM</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="glm.html"><a href="glm.html#what-is-the-glm"><i class="fa fa-check"></i><b>9.4.1</b> What is the GLM?</a></li>
<li class="chapter" data-level="9.4.2" data-path="glm.html"><a href="glm.html#glm-components"><i class="fa fa-check"></i><b>9.4.2</b> Components</a></li>
<li class="chapter" data-level="9.4.3" data-path="glm.html"><a href="glm.html#sim-glm"><i class="fa fa-check"></i><b>9.4.3</b> Simulating data from GLM</a></li>
<li class="chapter" data-level="9.4.4" data-path="glm.html"><a href="glm.html#linear-regression"><i class="fa fa-check"></i><b>9.4.4</b> Linear Regression</a></li>
<li class="chapter" data-level="9.4.5" data-path="glm.html"><a href="glm.html#residuals"><i class="fa fa-check"></i><b>9.4.5</b> Residuals</a></li>
<li class="chapter" data-level="9.4.6" data-path="glm.html"><a href="glm.html#predict"><i class="fa fa-check"></i><b>9.4.6</b> Predict New Values</a></li>
<li class="chapter" data-level="9.4.7" data-path="glm.html"><a href="glm.html#coding-schemes"><i class="fa fa-check"></i><b>9.4.7</b> Coding Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="glm.html"><a href="glm.html#test-rels"><i class="fa fa-check"></i><b>9.5</b> Relationships among tests</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="glm.html"><a href="glm.html#t-test-1"><i class="fa fa-check"></i><b>9.5.1</b> T-test</a></li>
<li class="chapter" data-level="9.5.2" data-path="glm.html"><a href="glm.html#anova"><i class="fa fa-check"></i><b>9.5.2</b> ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="glm.html"><a href="glm.html#understanding-anova"><i class="fa fa-check"></i><b>9.6</b> Understanding ANOVA</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="glm.html"><a href="glm.html#means-variability-and-deviation-scores"><i class="fa fa-check"></i><b>9.6.1</b> Means, Variability, and Deviation Scores</a></li>
<li class="chapter" data-level="9.6.2" data-path="glm.html"><a href="glm.html#decomp"><i class="fa fa-check"></i><b>9.6.2</b> Decomposition matrices</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="glm.html"><a href="glm.html#glossary9"><i class="fa fa-check"></i><b>9.7</b> Glossary</a></li>
<li class="chapter" data-level="9.8" data-path="glm.html"><a href="glm.html#exercises9"><i class="fa fa-check"></i><b>9.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="repro.html"><a href="repro.html"><i class="fa fa-check"></i><b>10</b> Reproducible Workflows</a>
<ul>
<li class="chapter" data-level="10.1" data-path="repro.html"><a href="repro.html#ilo10"><i class="fa fa-check"></i><b>10.1</b> Learning Objectives</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="repro.html"><a href="repro.html#basic-6"><i class="fa fa-check"></i><b>10.1.1</b> Basic</a></li>
<li class="chapter" data-level="10.1.2" data-path="repro.html"><a href="repro.html#intermediate-5"><i class="fa fa-check"></i><b>10.1.2</b> Intermediate</a></li>
<li class="chapter" data-level="10.1.3" data-path="repro.html"><a href="repro.html#advanced-2"><i class="fa fa-check"></i><b>10.1.3</b> Advanced</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="repro.html"><a href="repro.html#resources10"><i class="fa fa-check"></i><b>10.2</b> Resources</a></li>
<li class="chapter" data-level="10.3" data-path="repro.html"><a href="repro.html#setup10"><i class="fa fa-check"></i><b>10.3</b> Setup</a></li>
<li class="chapter" data-level="10.4" data-path="repro.html"><a href="repro.html#r-markdown"><i class="fa fa-check"></i><b>10.4</b> R Markdown</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="repro.html"><a href="repro.html#knitr-options"><i class="fa fa-check"></i><b>10.4.1</b> knitr options</a></li>
<li class="chapter" data-level="10.4.2" data-path="repro.html"><a href="repro.html#yaml-header"><i class="fa fa-check"></i><b>10.4.2</b> YAML Header</a></li>
<li class="chapter" data-level="10.4.3" data-path="repro.html"><a href="repro.html#toc-and-document-headers"><i class="fa fa-check"></i><b>10.4.3</b> TOC and Document Headers</a></li>
<li class="chapter" data-level="10.4.4" data-path="repro.html"><a href="repro.html#code-chunks"><i class="fa fa-check"></i><b>10.4.4</b> Code Chunks</a></li>
<li class="chapter" data-level="10.4.5" data-path="repro.html"><a href="repro.html#bibliography"><i class="fa fa-check"></i><b>10.4.5</b> Bibliography</a></li>
<li class="chapter" data-level="10.4.6" data-path="repro.html"><a href="repro.html#output-formats"><i class="fa fa-check"></i><b>10.4.6</b> Output Formats</a></li>
<li class="chapter" data-level="10.4.7" data-path="repro.html"><a href="repro.html#computational-reproducibility"><i class="fa fa-check"></i><b>10.4.7</b> Computational Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="repro.html"><a href="repro.html#glossary10"><i class="fa fa-check"></i><b>10.5</b> Glossary</a></li>
<li class="chapter" data-level="10.6" data-path="repro.html"><a href="repro.html#references"><i class="fa fa-check"></i><b>10.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i>Acknowledgements</a>
<ul>
<li class="chapter" data-level="10.7" data-path="acknowledgements.html"><a href="acknowledgements.html#contributors"><i class="fa fa-check"></i><b>10.7</b> Contributors</a></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="installingr.html"><a href="installingr.html"><i class="fa fa-check"></i><b>A</b> Installing R</a>
<ul>
<li class="chapter" data-level="A.1" data-path="installingr.html"><a href="installingr.html#installing-base-r"><i class="fa fa-check"></i><b>A.1</b> Installing Base R</a></li>
<li class="chapter" data-level="A.2" data-path="installingr.html"><a href="installingr.html#installing-rstudio"><i class="fa fa-check"></i><b>A.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="A.3" data-path="installingr.html"><a href="installingr.html#installing-latex"><i class="fa fa-check"></i><b>A.3</b> Installing LaTeX</a></li>
<li class="chapter" data-level="A.4" data-path="installingr.html"><a href="installingr.html#rstudio-online"><i class="fa fa-check"></i><b>A.4</b> RStudio Online</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="symbols.html"><a href="symbols.html"><i class="fa fa-check"></i><b>B</b> Symbols</a></li>
<li class="chapter" data-level="C" data-path="exercise-answers.html"><a href="exercise-answers.html"><i class="fa fa-check"></i><b>C</b> Exercise Answers</a></li>
<li class="chapter" data-level="D" data-path="datasets.html"><a href="datasets.html"><i class="fa fa-check"></i><b>D</b> Datasets</a></li>
<li class="chapter" data-level="E" data-path="bookrefs.html"><a href="bookrefs.html"><i class="fa fa-check"></i><b>E</b> References</a></li>
<li class="divider"></li>
<li><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" 
    target="blank"><img alt="Creative Commons License" 
    style="border-width:0" 
    src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><li>
<li><a href="https://psyteachr.github.io/" target="blank">PsyTeachR</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Skills for Reproducible Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="glm" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Introduction to GLM</h1>
<p><img src="images/memes/glm_meme.png" class="meme right"
     alt="Top panel: Fred from Scooby Doo, about to unmask a bound villain, with the text 't-test, ANOVA, Correlation, Regression, etc.'; Bottom panel: Villain unmasked, with the text: 'The general linear model'; credit: Stuart Ritchie"></p>
<!--
<img src="images/memes/linear_regression.jpg" class="meme right"
     alt="Woody and Buzz from Toy Story. Top text: Linear Regression; Bottom text: Linear regression everywhere">
     -->
<div id="ilo9" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Learning Objectives</h2>
<div id="basic-5" class="section level3" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Basic</h3>
<ol style="list-style-type: decimal">
<li>Define the <a href="glm.html#glm-components">components</a> of the GLM</li>
<li><a href="glm.html#sim-glm">Simulate data</a> using GLM equations <a href="https://youtu.be/JQ90LnVCbKc" class="video">(video)</a></li>
<li>Identify the model parameters that correspond to the data-generation parameters</li>
<li>Understand and plot <a href="glm.html#residuals">residuals</a> <a href="https://youtu.be/sr-NtxiH2Qk" class="video">(video)</a></li>
<li><a href="glm.html#predict">Predict new values</a> using the model <a href="https://youtu.be/0o4LEbVVWfM" class="video">(video)</a></li>
<li>Explain the differences among <a href="glm.html#coding-schemes">coding schemes</a> <a href="https://youtu.be/SqL28AbLj3g" class="video">(video)</a></li>
</ol>
</div>
<div id="intermediate-4" class="section level3" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Intermediate</h3>
<ol start="7" style="list-style-type: decimal">
<li>Demonstrate the <a href="glm.html#test-rels">relationships</a> among two-sample t-test, one-way ANOVA, and linear regression</li>
<li>Given data and a GLM, <a href="glm.html#decomp">generate a decomposition matrix</a> and calculate sums of squares, mean squares, and F ratios for a one-way ANOVA</li>
</ol>
</div>
</div>
<div id="resources9" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Resources</h2>
<ul>
<li><a href="stubs/9_glm.Rmd">Stub for this lesson</a></li>
<li><a href="http://www.otago.ac.nz/psychology/otago039309.pdf">Jeff Miller and Patricia Haden, Statistical Analysis with the Linear Model (free online textbook)</a></li>
<li><a href="slides/08_glm_slides.pdf">lecture slides introducing the General Linear Model</a></li>
<li><a href="http://rstudio2.psy.gla.ac.uk/Dale/GLM">GLM shiny app</a></li>
<li><a href="http://rstudio2.psy.gla.ac.uk/Dale/fdist">F distribution</a></li>
</ul>
</div>
<div id="setup9" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Setup</h2>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="glm.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="co"># libraries needed for these examples</span></span>
<span id="cb447-2"><a href="glm.html#cb447-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb447-3"><a href="glm.html#cb447-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb447-4"><a href="glm.html#cb447-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">30250</span>) <span class="co"># makes sure random numbers are reproducible</span></span></code></pre></div>
</div>
<div id="glm-1" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> GLM</h2>
<div id="what-is-the-glm" class="section level3" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> What is the GLM?</h3>
<p>The <a class='glossary' target='_blank' title='A mathematical model comparing how one or more independent variables affect a continuous dependent variable' href='https://psyteachr.github.io/glossary/g#general-linear-model'>General Linear Model</a> (GLM) is a general mathematical framework for expressing relationships among variables that can express or test linear relationships between a numerical <a class='glossary' target='_blank' title='The target variable that is being analyzed, whose value is assumed to depend on other variables.' href='https://psyteachr.github.io/glossary/d#dependent-variable'>dependent variable</a> and any combination of <a class='glossary' target='_blank' title='Data that can only take certain values, such as types of pet.' href='https://psyteachr.github.io/glossary/c#categorical'>categorical</a> or <a class='glossary' target='_blank' title='Data that can take on any values between other existing values.' href='https://psyteachr.github.io/glossary/c#continuous'>continuous</a> <a class='glossary' target='_blank' title='A variable whose value is assumed to influence the value of a dependent variable.' href='https://psyteachr.github.io/glossary/i#independent-variable'>independent variables</a>.</p>
</div>
<div id="glm-components" class="section level3" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> Components</h3>
<p>There are some mathematical conventions that you need to learn to understand the equations representing linear models. Once you understand those, learning about the GLM will get much easier.</p>
<table>
<thead>
<tr class="header">
<th>Component of GLM</th>
<th>Notation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Dependent Variable (DV)</td>
<td><span class="math inline">\(Y\)</span></td>
</tr>
<tr class="even">
<td>Grand Average</td>
<td><span class="math inline">\(\mu\)</span> (the Greek letter “mu”)</td>
</tr>
<tr class="odd">
<td>Main Effects</td>
<td><span class="math inline">\(A, B, C, \ldots\)</span></td>
</tr>
<tr class="even">
<td>Interactions</td>
<td><span class="math inline">\(AB, AC, BC, ABC, \ldots\)</span></td>
</tr>
<tr class="odd">
<td>Random Error</td>
<td><span class="math inline">\(S(Group)\)</span></td>
</tr>
</tbody>
</table>
<p><img src="images/memes/confused-math-lady.png" class="meme right"></p>
<p>The linear equation predicts the dependent variable (<span class="math inline">\(Y\)</span>) as the sum of the grand average value of <span class="math inline">\(Y\)</span> (<span class="math inline">\(\mu\)</span>, also called the intercept), the main effects of all the predictor variables (<span class="math inline">\(A+B+C+ \ldots\)</span>), the interactions among all the predictor variables (<span class="math inline">\(AB, AC, BC, ABC, \ldots\)</span>), and some random error (<span class="math inline">\(S(Group)\)</span>). The equation for a model with two predictor variables (<span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>) and their interaction (<span class="math inline">\(AB\)</span>) is written like this:</p>
<p><span class="math inline">\(Y\)</span> ~ <span class="math inline">\(\mu+A+B+AB+S(Group)\)</span></p>
<p>Don’t worry if this doesn’t make sense until we walk through a concrete example.</p>
</div>
<div id="sim-glm" class="section level3" number="9.4.3">
<h3><span class="header-section-number">9.4.3</span> Simulating data from GLM</h3>
<p>A good way to learn about linear models is to <a class='glossary' target='_blank' title='Generating data from summary parameters' href='https://psyteachr.github.io/glossary/s#simulation'>simulate</a> data where you know exactly how the variables are related, and then analyse this simulated data to see where the parameters show up in the analysis.</p>
<p>We’ll start with a very simple linear model that just has a single categorical factor with two levels. Let’s say we’re predicting reaction times for congruent and incongruent trials in a Stroop task for a single participant. Average reaction time (<code>mu</code>) is 800ms, and is 50ms faster for congruent than incongruent trials (<code>effect</code>).</p>
<div class="warning">
<p>A <strong>factor</strong> is a categorical variable that is used to divide subjects into groups, usually to draw some comparison. Factors are composed of different <strong>levels</strong>. Do not confuse factors with levels!</p>
<p>In the example above, trial type is a <select class='webex-solveme' data-answer='["factor"]'> <option></option> <option>factor</option> <option>level</option></select>, incongrunt is a <select class='webex-solveme' data-answer='["level"]'> <option></option> <option>factor</option> <option>level</option></select>, and congruent is a <select class='webex-solveme' data-answer='["level"]'> <option></option> <option>factor</option> <option>level</option></select>.</p>
</div>
<p>You need to represent <a class='glossary' target='_blank' title='Data that can only take certain values, such as types of pet.' href='https://psyteachr.github.io/glossary/c#categorical'>categorical</a> factors with numbers. The numbers, or <a class='glossary' target='_blank' title='How to represent categorical variables with numbers for use in models' href='https://psyteachr.github.io/glossary/c#coding-scheme'>coding scheme</a> you choose will affect the numbers you get out of the analysis and how you need to interpret them. Here, we will <a class='glossary' target='_blank' title='A coding scheme for categorical variables that contrasts each group mean with the mean of all the group means.' href='https://psyteachr.github.io/glossary/e#effect-code'>effect code</a> the trial types so that congruent trials are coded as +0.5, and incongruent trials are coded as -0.5.</p>
<p>A person won’t always respond exactly the same way. They might be a little faster on some trials than others, due to random fluctuations in attention, learning about the task, or fatigue. So we can add an <a class='glossary' target='_blank' title='The term in a model that represents the difference between the actual and predicted values' href='https://psyteachr.github.io/glossary/e#error-term'>error term</a> to each trial. We can’t know how much any specific trial will differ, but we can characterise the distribution of how much trials differ from average and then sample from this distribution.</p>
<p>Here, we’ll assume the error term is sampled from a <a class='glossary' target='_blank' title='A symmetric distribution of data where values near the centre are most probable.' href='https://psyteachr.github.io/glossary/n#normal-distribution'>normal distribution</a> with a <a class='glossary' target='_blank' title='A descriptive statistic that measures how spread out data are relative to the mean.' href='https://psyteachr.github.io/glossary/s#standard-deviation'>standard deviation</a> of 100 ms (the mean of the error term distribution is always 0). We’ll also sample 100 trials of each type, so we can see a range of variation.</p>
<p>So first create variables for all of the parameters that describe your data.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="glm.html#cb448-1" aria-hidden="true" tabindex="-1"></a>n_per_grp <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb448-2"><a href="glm.html#cb448-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">800</span> <span class="co"># average RT</span></span>
<span id="cb448-3"><a href="glm.html#cb448-3" aria-hidden="true" tabindex="-1"></a>effect <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co"># average difference between congruent and incongruent trials</span></span>
<span id="cb448-4"><a href="glm.html#cb448-4" aria-hidden="true" tabindex="-1"></a>error_sd <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># standard deviation of the error term</span></span>
<span id="cb448-5"><a href="glm.html#cb448-5" aria-hidden="true" tabindex="-1"></a>trial_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;congruent&quot;</span> <span class="ot">=</span> <span class="fl">0.5</span>, <span class="st">&quot;incongruent&quot;</span> <span class="ot">=</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="co"># effect code</span></span></code></pre></div>
<p>Then simulate the data by creating a data table with a row for each trial and columns for the trial type and the error term (random numbers samples from a normal distribution with the SD specified by <code>error_sd</code>). For categorical variables, include both a column with the text labels (<code>trial_type</code>) and another column with the coded version (<code>trial_type.e</code>) to make it easier to check what the codings mean and to use for graphing. Calculate the dependent variable (<code>RT</code>) as the sum of the grand mean (<code>mu</code>), the coefficient (<code>effect</code>) multiplied by the effect-coded predictor variable (<code>trial_type.e</code>), and the error term.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="glm.html#cb449-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb449-2"><a href="glm.html#cb449-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">trial_type =</span> <span class="fu">rep</span>(<span class="fu">names</span>(trial_types), <span class="at">each =</span> n_per_grp)</span>
<span id="cb449-3"><a href="glm.html#cb449-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb449-4"><a href="glm.html#cb449-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb449-5"><a href="glm.html#cb449-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">trial_type.e =</span> <span class="fu">recode</span>(trial_type, <span class="sc">!!!</span>trial_types),</span>
<span id="cb449-6"><a href="glm.html#cb449-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(.), <span class="dv">0</span>, error_sd),</span>
<span id="cb449-7"><a href="glm.html#cb449-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">RT =</span> mu <span class="sc">+</span> effect<span class="sc">*</span>trial_type.e <span class="sc">+</span> error</span>
<span id="cb449-8"><a href="glm.html#cb449-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="info">
<p>
The <code>!!!</code> (triple bang) in the code <code>recode(trial_type, !!!trial_types)</code> is a way to expand the vector <code>trial_types &lt;- c(“congruent” = 0.5, “incongruent” = -0.5)</code>. It’s equivalent to <code>recode(trial_type, “congruent” = 0.5, “incongruent” = -0.5)</code>. This pattern avoids making mistakes with recoding because there is only one place where you set up the category to code mapping (in the <code>trial_types</code> vector).
</p>
</div>
<p>Last but not least, always plot simulated data to make sure it looks like you expect.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="glm.html#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(trial_type, RT)) <span class="sc">+</span> </span>
<span id="cb450-2"><a href="glm.html#cb450-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb450-3"><a href="glm.html#cb450-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> trial_type), </span>
<span id="cb450-4"><a href="glm.html#cb450-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.25</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-sim"></span>
<img src="09-glm_files/figure-html/plot-sim-1.png" alt="Simulated Data" width="100%" />
<p class="caption">
Figure 9.1: Simulated Data
</p>
</div>
</div>
<div id="linear-regression" class="section level3" number="9.4.4">
<h3><span class="header-section-number">9.4.4</span> Linear Regression</h3>
<p>Now we can analyse the data we simulated using the function <code>lm()</code>. It takes the formula as the first argument. This is the same as the data-generating equation, but you can omit the error term (this is implied), and takes the data table as the second argument. Use the <code>summary()</code> function to see the statistical summary.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="glm.html#cb451-1" aria-hidden="true" tabindex="-1"></a>my_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(RT <span class="sc">~</span> trial_type.e, <span class="at">data =</span> dat)</span>
<span id="cb451-2"><a href="glm.html#cb451-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(my_lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RT ~ trial_type.e, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -302.110  -70.052    0.948   68.262  246.220 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   788.192      7.206 109.376  &lt; 2e-16 ***
## trial_type.e   61.938     14.413   4.297 2.71e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 101.9 on 198 degrees of freedom
## Multiple R-squared:  0.08532,    Adjusted R-squared:  0.0807 
## F-statistic: 18.47 on 1 and 198 DF,  p-value: 2.707e-05</code></pre>
<p>Notice how the <strong>estimate</strong> for the <code>(Intercept)</code> is close to the value we set for <code>mu</code> and the estimate for <code>trial_type.e</code> is close to the value we set for <code>effect</code>.</p>
<div class="try">
<p>
Change the values of <code>mu</code> and <code>effect</code>, resimulate the data, and re-run the linear model. What happens to the estimates?
</p>
</div>
</div>
<div id="residuals" class="section level3" number="9.4.5">
<h3><span class="header-section-number">9.4.5</span> Residuals</h3>
<p>You can use the <code>residuals()</code> function to extract the error term for each each data point. This is the DV values, minus the estimates for the intercept and trial type. We’ll make a density plot of the <a class='glossary' target='_blank' title='That part of an observation that cannot be captured by the statistical model, and thus is assumed to reflect unknown factors.' href='https://psyteachr.github.io/glossary/r#residual-error'>residuals</a> below and compare it to the normal distribution we used for the error term.</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="glm.html#cb453-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">residuals</span>(my_lm)</span>
<span id="cb453-2"><a href="glm.html#cb453-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span> </span>
<span id="cb453-3"><a href="glm.html#cb453-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="fu">aes</span>(<span class="dv">0</span>), <span class="at">color =</span> <span class="st">&quot;grey60&quot;</span>,</span>
<span id="cb453-4"><a href="glm.html#cb453-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">fun =</span> dnorm, <span class="at">n =</span> <span class="dv">101</span>,</span>
<span id="cb453-5"><a href="glm.html#cb453-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> error_sd)) <span class="sc">+</span></span>
<span id="cb453-6"><a href="glm.html#cb453-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(res, <span class="at">color =</span> trial_type))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:res-density-plot"></span>
<img src="09-glm_files/figure-html/res-density-plot-1.png" alt="Model residuals should be approximately normally distributed for each group" width="100%" />
<p class="caption">
Figure 9.2: Model residuals should be approximately normally distributed for each group
</p>
</div>
<p>You can also compare the model residuals to the simulated error values. If the model is accurate, they should be almost identical. If the intercept estimate is slightly off, the points will be slightly above or below the black line. If the estimate for the effect of trial type is slightly off, there will be a small, systematic difference between residuals for congruent and incongruent trials.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="glm.html#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb454-2"><a href="glm.html#cb454-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb454-3"><a href="glm.html#cb454-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(error, res,<span class="at">color =</span> trial_type)) <span class="sc">+</span></span>
<span id="cb454-4"><a href="glm.html#cb454-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Model Residuals&quot;</span>) <span class="sc">+</span></span>
<span id="cb454-5"><a href="glm.html#cb454-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Simulated Error&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:res-err-plot"></span>
<img src="09-glm_files/figure-html/res-err-plot-1.png" alt="Model residuals should be very similar to the simulated error" width="100%" />
<p class="caption">
Figure 9.3: Model residuals should be very similar to the simulated error
</p>
</div>
<div class="try">
<p>
What happens to the residuals if you fit a model that ignores trial type (e.g., <code>lm(Y ~ 1, data = dat)</code>)?
</p>
</div>
</div>
<div id="predict" class="section level3" number="9.4.6">
<h3><span class="header-section-number">9.4.6</span> Predict New Values</h3>
<p>You can use the estimates from your model to predict new data points, given values for the model parameters. For this simple example, we just need to know the trial type to make a prediction.</p>
<p>For congruent trials, you would predict that a new data point would be equal to the intercept estimate plus the trial type estimate multiplied by 0.5 (the effect code for congruent trials).</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="glm.html#cb455-1" aria-hidden="true" tabindex="-1"></a>int_est <span class="ot">&lt;-</span> my_lm<span class="sc">$</span>coefficients[[<span class="st">&quot;(Intercept)&quot;</span>]]</span>
<span id="cb455-2"><a href="glm.html#cb455-2" aria-hidden="true" tabindex="-1"></a>tt_est  <span class="ot">&lt;-</span> my_lm<span class="sc">$</span>coefficients[[<span class="st">&quot;trial_type.e&quot;</span>]]</span>
<span id="cb455-3"><a href="glm.html#cb455-3" aria-hidden="true" tabindex="-1"></a>tt_code <span class="ot">&lt;-</span> trial_types[[<span class="st">&quot;congruent&quot;</span>]]</span>
<span id="cb455-4"><a href="glm.html#cb455-4" aria-hidden="true" tabindex="-1"></a>new_congruent_RT <span class="ot">&lt;-</span> int_est <span class="sc">+</span> tt_est <span class="sc">*</span> tt_code</span>
<span id="cb455-5"><a href="glm.html#cb455-5" aria-hidden="true" tabindex="-1"></a>new_congruent_RT</span></code></pre></div>
<pre><code>## [1] 819.1605</code></pre>
<p>You can also use the <code>predict()</code> function to do this more easily. The second argument is a data table with columns for the factors in the model and rows with the values that you want to use for the prediction.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="glm.html#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(my_lm, <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">trial_type.e =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<pre><code>##        1 
## 819.1605</code></pre>
<div class="info">
<p>
If you look up this function using <code>?predict</code>, you will see that “The function invokes particular methods which depend on the class of the first argument.” What this means is that <code>predict()</code> works differently depending on whether you’re predicting from the output of <code>lm()</code> or other analysis functions. You can search for help on the lm version with <code>?predict.lm</code>.
</p>
</div>
</div>
<div id="coding-schemes" class="section level3" number="9.4.7">
<h3><span class="header-section-number">9.4.7</span> Coding Categorical Variables</h3>
<p>In the example above, we used <strong>effect coding</strong> for trial type. You can also use <strong>sum coding</strong>, which assigns +1 and -1 to the levels instead of +0.5 and -0.5. More commonly, you might want to use <strong>treatment coding</strong>, which assigns 0 to one level (usually a baseline or control condition) and 1 to the other level (usually a treatment or experimental condition).</p>
<p>Here we will add sum-coded and treatment-coded versions of <code>trial_type</code> to the dataset using the <code>recode()</code> function.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="glm.html#cb459-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb459-2"><a href="glm.html#cb459-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">trial_type.sum =</span> <span class="fu">recode</span>(trial_type, <span class="st">&quot;congruent&quot;</span> <span class="ot">=</span> <span class="sc">+</span><span class="dv">1</span>, <span class="st">&quot;incongruent&quot;</span> <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb459-3"><a href="glm.html#cb459-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">trial_type.tr =</span> <span class="fu">recode</span>(trial_type, <span class="st">&quot;congruent&quot;</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">&quot;incongruent&quot;</span> <span class="ot">=</span> <span class="dv">0</span>)</span>
<span id="cb459-4"><a href="glm.html#cb459-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>If you define named vectors with your levels and coding, you can use them with the <code>recode()</code> function if you expand them using <code>!!!</code>.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="glm.html#cb460-1" aria-hidden="true" tabindex="-1"></a>tt_sum <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;congruent&quot;</span>   <span class="ot">=</span> <span class="sc">+</span><span class="dv">1</span>, </span>
<span id="cb460-2"><a href="glm.html#cb460-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;incongruent&quot;</span> <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb460-3"><a href="glm.html#cb460-3" aria-hidden="true" tabindex="-1"></a>tt_tr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;congruent&quot;</span>   <span class="ot">=</span> <span class="dv">1</span>, </span>
<span id="cb460-4"><a href="glm.html#cb460-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;incongruent&quot;</span> <span class="ot">=</span> <span class="dv">0</span>)</span>
<span id="cb460-5"><a href="glm.html#cb460-5" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb460-6"><a href="glm.html#cb460-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">trial_type.sum =</span> <span class="fu">recode</span>(trial_type, <span class="sc">!!!</span>tt_sum),</span>
<span id="cb460-7"><a href="glm.html#cb460-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trial_type.tr =</span> <span class="fu">recode</span>(trial_type, <span class="sc">!!!</span>tt_tr)</span>
<span id="cb460-8"><a href="glm.html#cb460-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Here are the coefficients for the effect-coded version. They should be the same as those from the last analysis.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="glm.html#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(RT <span class="sc">~</span> trial_type.e, <span class="at">data =</span> dat)<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>##  (Intercept) trial_type.e 
##    788.19166     61.93773</code></pre>
<p>Here are the coefficients for the sum-coded version. This give the same results as effect coding, except the estimate for the categorical factor will be exactly half as large, as it represents the difference between each trial type and the hypothetical condition of 0 (the overall mean RT), rather than the difference between the two trial types.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="glm.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(RT <span class="sc">~</span> trial_type.sum, <span class="at">data =</span> dat)<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>##    (Intercept) trial_type.sum 
##      788.19166       30.96887</code></pre>
<p>Here are the coefficients for the treatment-coded version. The estimate for the categorical factor will be the same as in the effect-coded version, but the intercept will decrease. It will be equal to the intercept minus the estimate for trial type from the sum-coded version.</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="glm.html#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(RT <span class="sc">~</span> trial_type.tr, <span class="at">data =</span> dat)<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>##   (Intercept) trial_type.tr 
##     757.22279      61.93773</code></pre>
</div>
</div>
<div id="test-rels" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> Relationships among tests</h2>
<div id="t-test-1" class="section level3" number="9.5.1">
<h3><span class="header-section-number">9.5.1</span> T-test</h3>
<p>The t-test is just a special, limited example of a general linear model.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="glm.html#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(RT <span class="sc">~</span> trial_type.e, <span class="at">data =</span> dat, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  RT by trial_type.e
## t = -4.2975, df = 198, p-value = 2.707e-05
## alternative hypothesis: true difference in means between group -0.5 and group 0.5 is not equal to 0
## 95 percent confidence interval:
##  -90.35945 -33.51601
## sample estimates:
## mean in group -0.5  mean in group 0.5 
##           757.2228           819.1605</code></pre>
<div class="try">
<p>
What happens when you use other codings for trial type in the t-test above? Which coding maps onto the results of the t-test best?
</p>
</div>
</div>
<div id="anova" class="section level3" number="9.5.2">
<h3><span class="header-section-number">9.5.2</span> ANOVA</h3>
<p>ANOVA is also a special, limited version of the linear model.</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="glm.html#cb469-1" aria-hidden="true" tabindex="-1"></a>my_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(RT <span class="sc">~</span> trial_type.e, <span class="at">data =</span> dat)</span>
<span id="cb469-2"><a href="glm.html#cb469-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(my_aov, <span class="at">intercept =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##               Df    Sum Sq   Mean Sq  F value   Pr(&gt;F)    
## (Intercept)    1 124249219 124249219 11963.12  &lt; 2e-16 ***
## trial_type.e   1    191814    191814    18.47 2.71e-05 ***
## Residuals    198   2056432     10386                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The easiest way to get parameters out of an analysis is to use the <code>broom::tidy()</code> function. This returns a tidy table that you can extract numbers of interest from. Here, we just want to get the F-value for the effect of trial_type. Compare the square root of this value to the t-value from the t-tests above.</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="glm.html#cb471-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(my_aov)<span class="sc">$</span>statistic[<span class="dv">1</span>]</span>
<span id="cb471-2"><a href="glm.html#cb471-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(f)</span></code></pre></div>
<pre><code>## [1] 4.297498</code></pre>
</div>
</div>
<div id="understanding-anova" class="section level2" number="9.6">
<h2><span class="header-section-number">9.6</span> Understanding ANOVA</h2>
<p>We’ll walk through an example of a one-way ANOVA with the following equation:</p>
<p><span class="math inline">\(Y_{ij} = \mu + A_i + S(A)_{ij}\)</span></p>
<p>This means that each data point (<span class="math inline">\(Y_{ij}\)</span>) is predicted to be the sum of the grand mean (<span class="math inline">\(\mu\)</span>), plus the effect of factor A (<span class="math inline">\(A_i\)</span>), plus some residual error (<span class="math inline">\(S(A)_{ij}\)</span>).</p>
<div id="means-variability-and-deviation-scores" class="section level3" number="9.6.1">
<h3><span class="header-section-number">9.6.1</span> Means, Variability, and Deviation Scores</h3>
<p>Let’s create a simple simulation function so you can quickly create a two-sample dataset with specified Ns, means, and SDs.</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="glm.html#cb473-1" aria-hidden="true" tabindex="-1"></a>two_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">m1 =</span> <span class="dv">0</span>, <span class="at">m2 =</span> <span class="dv">0</span>, <span class="at">sd1 =</span> <span class="dv">1</span>, <span class="at">sd2 =</span> <span class="dv">1</span>) {</span>
<span id="cb473-2"><a href="glm.html#cb473-2" aria-hidden="true" tabindex="-1"></a>  s1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, m1, sd1)</span>
<span id="cb473-3"><a href="glm.html#cb473-3" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, m2, sd2)</span>
<span id="cb473-4"><a href="glm.html#cb473-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb473-5"><a href="glm.html#cb473-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb473-6"><a href="glm.html#cb473-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">c</span>(s1, s2),</span>
<span id="cb473-7"><a href="glm.html#cb473-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">grp =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="at">each =</span> n)</span>
<span id="cb473-8"><a href="glm.html#cb473-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb473-9"><a href="glm.html#cb473-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we will use <code>two_sample()</code> to create a dataset <code>dat</code> with N=5 per group, means of -2 and +2, and SDs of 1 and 1 (yes, this is an effect size of d = 4).</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="glm.html#cb474-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">two_sample</span>(<span class="dv">5</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">+</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span></code></pre></div>
<p>You can calculate how each data point (<code>Y</code>) deviates from the overall sample mean (<span class="math inline">\(\hat{\mu}\)</span>), which is represented by the horizontal grey line below and the deviations are the vertical grey lines. You can also calculate how different each point is from its group-specific mean (<span class="math inline">\(\hat{A_i}\)</span>), which are represented by the horizontal coloured lines below and the deviations are the coloured vertical lines.</p>
<div class="figure" style="text-align: center"><span id="fig:deviation"></span>
<img src="09-glm_files/figure-html/deviation-1.png" alt="Deviations of each data point (Y) from the overall and group means" width="100%" />
<p class="caption">
Figure 9.4: Deviations of each data point (Y) from the overall and group means
</p>
</div>
<p>You can use these deviations to calculate variability between groups and within groups. ANOVA tests whether the variability between groups is larger than that within groups, accounting for the number of groups and observations.</p>
</div>
<div id="decomp" class="section level3" number="9.6.2">
<h3><span class="header-section-number">9.6.2</span> Decomposition matrices</h3>
<p>We can use the estimation equations for a one-factor ANOVA to calculate the model components.</p>
<ul>
<li><code>mu</code> is the overall mean</li>
<li><code>a</code> is how different each group mean is from the overall mean</li>
<li><code>err</code> is residual error, calculated by subtracting <code>mu</code> and <code>a</code> from <code>Y</code></li>
</ul>
<p>This produces a <em>decomposition matrix</em>, a table with columns for <code>Y</code>, <code>mu</code>, <code>a</code>, and <code>err</code>.</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="glm.html#cb475-1" aria-hidden="true" tabindex="-1"></a>decomp <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> </span>
<span id="cb475-2"><a href="glm.html#cb475-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Y, grp) <span class="sc">%&gt;%</span></span>
<span id="cb475-3"><a href="glm.html#cb475-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mu =</span> <span class="fu">mean</span>(Y)) <span class="sc">%&gt;%</span>     <span class="co"># calculate mu_hat</span></span>
<span id="cb475-4"><a href="glm.html#cb475-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(grp) <span class="sc">%&gt;%</span></span>
<span id="cb475-5"><a href="glm.html#cb475-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a =</span> <span class="fu">mean</span>(Y) <span class="sc">-</span> mu) <span class="sc">%&gt;%</span> <span class="co"># calculate a_hat for each grp</span></span>
<span id="cb475-6"><a href="glm.html#cb475-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb475-7"><a href="glm.html#cb475-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">err =</span> Y <span class="sc">-</span> mu <span class="sc">-</span> a)     <span class="co"># calculate residual error</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Y</th>
<th align="left">grp</th>
<th align="right">mu</th>
<th align="right">a</th>
<th align="right">err</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-1.4770938</td>
<td align="left">A</td>
<td align="right">0.1207513</td>
<td align="right">-1.533501</td>
<td align="right">-0.0643443</td>
</tr>
<tr class="even">
<td align="right">-2.9508741</td>
<td align="left">A</td>
<td align="right">0.1207513</td>
<td align="right">-1.533501</td>
<td align="right">-1.5381246</td>
</tr>
<tr class="odd">
<td align="right">-0.6376736</td>
<td align="left">A</td>
<td align="right">0.1207513</td>
<td align="right">-1.533501</td>
<td align="right">0.7750759</td>
</tr>
<tr class="even">
<td align="right">-1.7579084</td>
<td align="left">A</td>
<td align="right">0.1207513</td>
<td align="right">-1.533501</td>
<td align="right">-0.3451589</td>
</tr>
<tr class="odd">
<td align="right">-0.2401977</td>
<td align="left">A</td>
<td align="right">0.1207513</td>
<td align="right">-1.533501</td>
<td align="right">1.1725518</td>
</tr>
<tr class="even">
<td align="right">0.1968155</td>
<td align="left">B</td>
<td align="right">0.1207513</td>
<td align="right">1.533501</td>
<td align="right">-1.4574367</td>
</tr>
<tr class="odd">
<td align="right">2.6308008</td>
<td align="left">B</td>
<td align="right">0.1207513</td>
<td align="right">1.533501</td>
<td align="right">0.9765486</td>
</tr>
<tr class="even">
<td align="right">2.0293297</td>
<td align="left">B</td>
<td align="right">0.1207513</td>
<td align="right">1.533501</td>
<td align="right">0.3750775</td>
</tr>
<tr class="odd">
<td align="right">2.1629037</td>
<td align="left">B</td>
<td align="right">0.1207513</td>
<td align="right">1.533501</td>
<td align="right">0.5086516</td>
</tr>
<tr class="even">
<td align="right">1.2514112</td>
<td align="left">B</td>
<td align="right">0.1207513</td>
<td align="right">1.533501</td>
<td align="right">-0.4028410</td>
</tr>
</tbody>
</table>
<p>Calculate sums of squares for <code>mu</code>, <code>a</code>, and <code>err</code>.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="glm.html#cb476-1" aria-hidden="true" tabindex="-1"></a>SS <span class="ot">&lt;-</span> decomp <span class="sc">%&gt;%</span></span>
<span id="cb476-2"><a href="glm.html#cb476-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mu =</span> <span class="fu">sum</span>(mu<span class="sc">*</span>mu),</span>
<span id="cb476-3"><a href="glm.html#cb476-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">a =</span> <span class="fu">sum</span>(a<span class="sc">*</span>a),</span>
<span id="cb476-4"><a href="glm.html#cb476-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">err =</span> <span class="fu">sum</span>(err<span class="sc">*</span>err))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">mu</th>
<th align="right">a</th>
<th align="right">err</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1458088</td>
<td align="right">23.51625</td>
<td align="right">8.104182</td>
</tr>
</tbody>
</table>
<p>If you’ve done everything right, <code>SS$mu + SS$a + SS$err</code> should equal the sum of squares for Y.</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="glm.html#cb477-1" aria-hidden="true" tabindex="-1"></a>SS_Y <span class="ot">&lt;-</span> <span class="fu">sum</span>(decomp<span class="sc">$</span>Y<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb477-2"><a href="glm.html#cb477-2" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(SS_Y, SS<span class="sc">$</span>mu <span class="sc">+</span> SS<span class="sc">$</span>a <span class="sc">+</span> SS<span class="sc">$</span>err)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Divide each sum of squares by its corresponding degrees of freedom (df) to calculate mean squares. The df for <code>mu</code> is 1, the df for factor <code>a</code> is <code>K-1</code> (K is the number of groups), and the df for <code>err</code> is <code>N - K</code> (N is the number of observations).</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="glm.html#cb479-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">n_distinct</span>(dat<span class="sc">$</span>grp)</span>
<span id="cb479-2"><a href="glm.html#cb479-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dat)</span>
<span id="cb479-3"><a href="glm.html#cb479-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">mu =</span> <span class="dv">1</span>, <span class="at">a =</span> K <span class="sc">-</span> <span class="dv">1</span>, <span class="at">err =</span> N <span class="sc">-</span> K)</span>
<span id="cb479-4"><a href="glm.html#cb479-4" aria-hidden="true" tabindex="-1"></a>MS <span class="ot">&lt;-</span> SS <span class="sc">/</span> df</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">mu</th>
<th align="right">a</th>
<th align="right">err</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1458088</td>
<td align="right">23.51625</td>
<td align="right">1.013023</td>
</tr>
</tbody>
</table>
<p>Then calculate an F-ratio for <code>mu</code> and <code>a</code> by dividing their mean squares by the error term mean square. Get the p-values that correspond to these F-values using the <code>pf()</code> function.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="glm.html#cb480-1" aria-hidden="true" tabindex="-1"></a>F_mu <span class="ot">&lt;-</span> MS<span class="sc">$</span>mu <span class="sc">/</span> MS<span class="sc">$</span>err</span>
<span id="cb480-2"><a href="glm.html#cb480-2" aria-hidden="true" tabindex="-1"></a>F_a  <span class="ot">&lt;-</span> MS<span class="sc">$</span>a  <span class="sc">/</span> MS<span class="sc">$</span>err</span>
<span id="cb480-3"><a href="glm.html#cb480-3" aria-hidden="true" tabindex="-1"></a>p_mu <span class="ot">&lt;-</span> <span class="fu">pf</span>(F_mu, <span class="at">df1 =</span> df[<span class="st">&#39;mu&#39;</span>], <span class="at">df2 =</span> df[<span class="st">&#39;err&#39;</span>], <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb480-4"><a href="glm.html#cb480-4" aria-hidden="true" tabindex="-1"></a>p_a  <span class="ot">&lt;-</span> <span class="fu">pf</span>(F_a,  <span class="at">df1 =</span> df[<span class="st">&#39;a&#39;</span>],  <span class="at">df2 =</span> df[<span class="st">&#39;err&#39;</span>], <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Put everything into a data frame to display it in the same way as the ANOVA summary function.</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="glm.html#cb481-1" aria-hidden="true" tabindex="-1"></a>my_calcs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb481-2"><a href="glm.html#cb481-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">term =</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;grp&quot;</span>, <span class="st">&quot;Residuals&quot;</span>),</span>
<span id="cb481-3"><a href="glm.html#cb481-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Df =</span> df,</span>
<span id="cb481-4"><a href="glm.html#cb481-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">SS =</span> <span class="fu">c</span>(SS<span class="sc">$</span>mu, SS<span class="sc">$</span>a, SS<span class="sc">$</span>err),</span>
<span id="cb481-5"><a href="glm.html#cb481-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">MS =</span> <span class="fu">c</span>(MS<span class="sc">$</span>mu, MS<span class="sc">$</span>a, MS<span class="sc">$</span>err),</span>
<span id="cb481-6"><a href="glm.html#cb481-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">F =</span> <span class="fu">c</span>(F_mu, F_a, <span class="cn">NA</span>),</span>
<span id="cb481-7"><a href="glm.html#cb481-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> <span class="fu">c</span>(p_mu, p_a, <span class="cn">NA</span>)</span>
<span id="cb481-8"><a href="glm.html#cb481-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">term</th>
<th align="right">Df</th>
<th align="right">SS</th>
<th align="right">MS</th>
<th align="right">F</th>
<th align="right">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mu</td>
<td align="left">Intercept</td>
<td align="right">1</td>
<td align="right">0.146</td>
<td align="right">0.146</td>
<td align="right">0.144</td>
<td align="right">0.714</td>
</tr>
<tr class="even">
<td align="left">a</td>
<td align="left">grp</td>
<td align="right">1</td>
<td align="right">23.516</td>
<td align="right">23.516</td>
<td align="right">23.214</td>
<td align="right">0.001</td>
</tr>
<tr class="odd">
<td align="left">err</td>
<td align="left">Residuals</td>
<td align="right">8</td>
<td align="right">8.104</td>
<td align="right">1.013</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>Now run a one-way ANOVA on your results and compare it to what you obtained in your calculations.</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="glm.html#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(Y <span class="sc">~</span> grp, <span class="at">data =</span> dat) <span class="sc">%&gt;%</span> <span class="fu">summary</span>(<span class="at">intercept =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## (Intercept)  1  0.146   0.146   0.144 0.71427   
## grp          1 23.516  23.516  23.214 0.00132 **
## Residuals    8  8.104   1.013                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="try">
<p>
Using the code above, write your own function that takes a table of data and returns the ANOVA results table like above.
</p>
</div>
</div>
</div>
<div id="glossary9" class="section level2" number="9.7">
<h2><span class="header-section-number">9.7</span> Glossary</h2>
<table>
<colgroup>
<col width="50%" />
<col width="49%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a class='glossary' target='_blank' href='https://psyteachr.github.io/glossary/c#categorical'>categorical</a></td>
<td align="left">Data that can only take certain values, such as types of pet.</td>
</tr>
<tr class="even">
<td align="left"><a class='glossary' target='_blank' href='https://psyteachr.github.io/glossary/c#coding.scheme'>coding scheme</a></td>
<td align="left">How to represent categorical variables with numbers for use in models</td>
</tr>
<tr class="odd">
<td align="left"><a class='glossary' target='_blank' href='https://psyteachr.github.io/glossary/c#continuous'>continuous</a></td>
<td align="left">Data that can take on any values between other existing values.</td>
</tr>
<tr class="even">
<td align="left"><a class='glossary' target='_blank' href='https://psyteachr.github.io/glossary/d#dependent.variable'>dependent variable</a></td>
<td align="left">The target variable that is being analyzed, whose value is assumed to depend on other variables.</td>
</tr>
<tr class="odd">
<td align="left"><a class='glossary' target='_blank' href='https://psyteachr.github.io/glossary/e#effect.code'>effect code</a></td>
<td align="left">A coding scheme for categorical variables that contrasts each group mean with the mean of all the group means.</td>
</tr>
<tr class="even">
<td align="left"><a class='glossary' target='_blank' href='https://psyteachr.github.io/glossary/e#error.term'>error term</a></td>
<td align="left">The term in a model that represents the difference between the actual and predicted values</td>
</tr>
<tr class="odd">
<td align="left"><a class='glossary' target='_blank' href='https://psyteachr.github.io/glossary/g#general.linear.model'>general linear model</a></td>
<td align="left">A mathematical model comparing how one or more independent variables affect a continuous dependent variable</td>
</tr>
<tr class="even">
<td align="left"><a class='glossary' target='_blank' href='https://psyteachr.github.io/glossary/i#independent.variable'>independent variable</a></td>
<td align="left">A variable whose value is assumed to influence the value of a dependent variable.</td>
</tr>
<tr class="odd">
<td align="left"><a class='glossary' target='_blank' href='https://psyteachr.github.io/glossary/n#normal.distribution'>normal distribution</a></td>
<td align="left">A symmetric distribution of data where values near the centre are most probable.</td>
</tr>
<tr class="even">
<td align="left"><a class='glossary' target='_blank' href='https://psyteachr.github.io/glossary/r#residual.error'>residual error</a></td>
<td align="left">That part of an observation that cannot be captured by the statistical model, and thus is assumed to reflect unknown factors.</td>
</tr>
<tr class="odd">
<td align="left"><a class='glossary' target='_blank' href='https://psyteachr.github.io/glossary/s#simulation'>simulation</a></td>
<td align="left">Generating data from summary parameters</td>
</tr>
<tr class="even">
<td align="left"><a class='glossary' target='_blank' href='https://psyteachr.github.io/glossary/s#standard.deviation'>standard deviation</a></td>
<td align="left">A descriptive statistic that measures how spread out data are relative to the mean.</td>
</tr>
</tbody>
</table>
</div>
<div id="exercises9" class="section level2" number="9.8">
<h2><span class="header-section-number">9.8</span> Exercises</h2>
<p>Download the <a href="exercises/09_glm_exercise.Rmd">exercises</a>. See the <a href="exercises/09_glm_answers.Rmd">answers</a> only after you’ve attempted all the questions.</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="glm.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run this to access the exercise</span></span>
<span id="cb484-2"><a href="glm.html#cb484-2" aria-hidden="true" tabindex="-1"></a>dataskills<span class="sc">::</span><span class="fu">exercise</span>(<span class="dv">9</span>)</span>
<span id="cb484-3"><a href="glm.html#cb484-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb484-4"><a href="glm.html#cb484-4" aria-hidden="true" tabindex="-1"></a><span class="co"># run this to access the answers</span></span>
<span id="cb484-5"><a href="glm.html#cb484-5" aria-hidden="true" tabindex="-1"></a>dataskills<span class="sc">::</span><span class="fu">exercise</span>(<span class="dv">9</span>, <span class="at">answers =</span> <span class="cn">TRUE</span>)</span></code></pre></div>

</div>
</div>
<div class="psyteachr_footer">
  
</div>
<script>

/* update total correct if #total_correct exists */
update_total_correct = function() {
  if (t = document.getElementById("total_correct")) {
    t.innerHTML =
      document.getElementsByClassName("correct").length + " of " +
      document.getElementsByClassName("solveme").length + " correct";
  }
}

/* solution button toggling function */
b_func = function() {
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "");
  }
  
  if (my_answer !== "" & real_answers.includes(my_answer)) {
    cl.add("correct");
  } else {
    cl.remove("correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol){
    var tol = JSON.parse(this.dataset.tol);  
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("correct");
    } else {
      cl.remove("correct");
    }  
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("correct");
    }  
  }
  
  update_total_correct();
}

window.onload = function() {
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('solution')) {
      buttons[i].onclick = b_func;
    }
  }
  
  /* set up solveme inputs */
  var solveme = document.getElementsByClassName("solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off"); 
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";
    
    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;
    
    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="sim.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="repro.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": {},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
